{
"version":3,
"file":"goog.debug.errorhandler.js",
"lineCount":167,
"mappings":"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",
"sources":["goog/debug/errorhandler.js"],
"sourcesContent":["/**\n * @license\n * Copyright The Closure Library Authors.\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Error handling utilities.\n */\n\ngoog.provide('goog.debug.ErrorHandler');\ngoog.provide('goog.debug.ErrorHandler.ProtectedFunctionError');\n\ngoog.require('goog.Disposable');\ngoog.require('goog.asserts');\ngoog.require('goog.debug');\ngoog.require('goog.debug.EntryPointMonitor');\ngoog.require('goog.debug.Error');\ngoog.require('goog.debug.Trace');\n\n\n\n/**\n * The ErrorHandler can be used to to wrap functions with a try/catch\n * statement. If an exception is thrown, the given error handler function will\n * be called.\n *\n * When this object is disposed, it will stop handling exceptions and tracing.\n * It will also try to restore window.setTimeout and window.setInterval\n * if it wrapped them. Notice that in the general case, it is not technically\n * possible to remove the wrapper, because functions have no knowledge of\n * what they have been assigned to. So the app is responsible for other\n * forms of unwrapping.\n *\n * @param {Function} handler Handler for exceptions.\n * @constructor\n * @extends {goog.Disposable}\n * @implements {goog.debug.EntryPointMonitor}\n */\ngoog.debug.ErrorHandler = function(handler) {\n  'use strict';\n  goog.debug.ErrorHandler.base(this, 'constructor');\n\n  /**\n   * Handler for exceptions, which can do logging, reporting, etc.\n   * @type {Function}\n   * @private\n   */\n  this.errorHandlerFn_ = handler;\n\n  /**\n   * Whether errors should be wrapped in\n   * goog.debug.ErrorHandler.ProtectedFunctionError before rethrowing.\n   * @type {boolean}\n   * @private\n   */\n  this.wrapErrors_ = true;  // TODO(malteubl) Change default.\n\n  /**\n   * Whether to add a prefix to all error messages. The prefix is\n   * goog.debug.ErrorHandler.ProtectedFunctionError.MESSAGE_PREFIX. This option\n   * only has an effect if this.wrapErrors_  is set to false.\n   * @type {boolean}\n   * @private\n   */\n  this.prefixErrorMessages_ = false;\n};\ngoog.inherits(goog.debug.ErrorHandler, goog.Disposable);\n\n\n/**\n * Whether to add tracers when instrumenting entry points.\n * @type {boolean}\n * @private\n */\ngoog.debug.ErrorHandler.prototype.addTracersToProtectedFunctions_ = false;\n\n\n/**\n * Enable tracers when instrumenting entry points.\n * @param {boolean} newVal See above.\n */\ngoog.debug.ErrorHandler.prototype.setAddTracersToProtectedFunctions = function(\n    newVal) {\n  'use strict';\n  this.addTracersToProtectedFunctions_ = newVal;\n};\n\n\n/** @override */\ngoog.debug.ErrorHandler.prototype.wrap = function(fn) {\n  'use strict';\n  return this.protectEntryPoint(goog.asserts.assertFunction(fn));\n};\n\n\n/** @override */\ngoog.debug.ErrorHandler.prototype.unwrap = function(fn) {\n  'use strict';\n  goog.asserts.assertFunction(fn);\n  return fn[this.getFunctionIndex_(false)] || fn;\n};\n\n\n/**\n * Private helper function to return a span that can be clicked on to display\n * an alert with the current stack trace. Newlines are replaced with a\n * placeholder so that they will not be html-escaped.\n * @param {string} stackTrace The stack trace to create a span for.\n * @return {string} A span which can be clicked on to show the stack trace.\n * @private\n */\ngoog.debug.ErrorHandler.prototype.getStackTraceHolder_ = function(stackTrace) {\n  'use strict';\n  var buffer = [];\n  buffer.push('##PE_STACK_START##');\n  buffer.push(stackTrace.replace(/(\\r\\n|\\r|\\n)/g, '##STACK_BR##'));\n  buffer.push('##PE_STACK_END##');\n  return buffer.join('');\n};\n\n\n/**\n * Get the index for a function. Used for internal indexing.\n * @param {boolean} wrapper True for the wrapper; false for the wrapped.\n * @return {string} The index where we should store the function in its\n *     wrapper/wrapped function.\n * @private\n */\ngoog.debug.ErrorHandler.prototype.getFunctionIndex_ = function(wrapper) {\n  'use strict';\n  return (wrapper ? '__wrapper_' : '__protected_') + goog.getUid(this) + '__';\n};\n\n\n/**\n * Installs exception protection for an entry point function. When an exception\n * is thrown from a protected function, a handler will be invoked to handle it.\n *\n * @param {Function} fn An entry point function to be protected.\n * @return {!Function} A protected wrapper function that calls the entry point\n *     function.\n */\ngoog.debug.ErrorHandler.prototype.protectEntryPoint = function(fn) {\n  'use strict';\n  var protectedFnName = this.getFunctionIndex_(true);\n  if (!fn[protectedFnName]) {\n    var wrapper = fn[protectedFnName] = this.getProtectedFunction(fn);\n    wrapper[this.getFunctionIndex_(false)] = fn;\n  }\n  return fn[protectedFnName];\n};\n\n\n/**\n * Helps {@link #protectEntryPoint} by actually creating the protected\n * wrapper function, after {@link #protectEntryPoint} determines that one does\n * not already exist for the given function.  Can be overridden by subclasses\n * that may want to implement different error handling, or add additional\n * entry point hooks.\n * @param {!Function} fn An entry point function to be protected.\n * @return {!Function} protected wrapper function.\n * @protected\n */\ngoog.debug.ErrorHandler.prototype.getProtectedFunction = function(fn) {\n  'use strict';\n  var that = this;\n  var tracers = this.addTracersToProtectedFunctions_;\n  if (tracers) {\n    var stackTrace = goog.debug.getStacktraceSimple(15);\n  }\n  var googDebugErrorHandlerProtectedFunction = function() {\n    'use strict';\n    var self = /** @type {?} */ (this);\n    if (that.isDisposed()) {\n      return fn.apply(self, arguments);\n    }\n\n    if (tracers) {\n      var tracer = goog.debug.Trace.startTracer(\n          'protectedEntryPoint: ' + that.getStackTraceHolder_(stackTrace));\n    }\n    try {\n      return fn.apply(self, arguments);\n    } catch (e) {\n      that.handleError_(e);\n    } finally {\n      if (tracers) {\n        goog.debug.Trace.stopTracer(tracer);\n      }\n    }\n  };\n  googDebugErrorHandlerProtectedFunction[this.getFunctionIndex_(false)] = fn;\n  return googDebugErrorHandlerProtectedFunction;\n};\n\n\n/**\n * Internal error handler.\n * @param {?} e The error string or an Error-like object.\n * @private\n */\ngoog.debug.ErrorHandler.prototype.handleError_ = function(e) {\n  'use strict';\n  // Don't re-report errors that have already been handled by this code.\n  var MESSAGE_PREFIX =\n      goog.debug.ErrorHandler.ProtectedFunctionError.MESSAGE_PREFIX;\n  if ((e && typeof e === 'object' && typeof e.message === 'string' &&\n       e.message.indexOf(MESSAGE_PREFIX) == 0) ||\n      (typeof e === 'string' && e.indexOf(MESSAGE_PREFIX) == 0)) {\n    return;\n  }\n  this.errorHandlerFn_(e);\n  if (!this.wrapErrors_) {\n    // Add the prefix to the existing message.\n    if (this.prefixErrorMessages_) {\n      if (typeof e === 'object' && e && typeof e.message === 'string') {\n        /** @type {{message}} */ (e).message = MESSAGE_PREFIX + e.message;\n      } else {\n        e = MESSAGE_PREFIX + e;\n      }\n    }\n    if (goog.DEBUG) {\n      // Work around for https://code.google.com/p/v8/issues/detail?id=2625\n      // and https://code.google.com/p/chromium/issues/detail?id=237059\n      // Custom errors and errors with custom stack traces show the wrong\n      // stack trace\n      // If it has a stack and Error.captureStackTrace is supported (only\n      // supported in V8 as of May 2013) log the stack to the console.\n      if (e && typeof e.stack === 'string' && Error.captureStackTrace &&\n          goog.global['console']) {\n        goog.global['console']['error'](e.message, e.stack);\n      }\n    }\n    // Re-throw original error. This is great for debugging as it makes\n    // browser JS dev consoles show the correct error and stack trace.\n    throw e;\n  }\n  // Re-throw it since this may be expected by the caller.\n  throw new goog.debug.ErrorHandler.ProtectedFunctionError(e);\n};\n\n\n// TODO(mknichel): Allow these functions to take in the window to protect.\n/**\n * Installs exception protection for window.setTimeout to handle exceptions.\n */\ngoog.debug.ErrorHandler.prototype.protectWindowSetTimeout = function() {\n  'use strict';\n  this.protectWindowFunctionsHelper_('setTimeout');\n};\n\n\n/**\n * Install exception protection for window.setInterval to handle exceptions.\n */\ngoog.debug.ErrorHandler.prototype.protectWindowSetInterval = function() {\n  'use strict';\n  this.protectWindowFunctionsHelper_('setInterval');\n};\n\n\n/**\n * Install an unhandledrejection event listener that reports rejected promises.\n * Note: this will only work with Chrome 49+ and friends, but so far is the only\n * way to report uncaught errors in aysnc/await functions.\n * @param {!Window=} win the window to instrument, defaults to current window\n */\ngoog.debug.ErrorHandler.prototype.catchUnhandledRejections = function(win) {\n  'use strict';\n  win = win || goog.global['window'];\n  if ('onunhandledrejection' in win) {\n    win.onunhandledrejection = (event) => {\n      // event.reason contains the rejection reason. When an Error is\n      // thrown, this is the Error object. If it is undefined, create a new\n      // error object.\n      const e =\n          event && event.reason ? event.reason : new Error('uncaught error');\n      this.handleError_(e);\n    };\n  }\n};\n\n\n/**\n * Install exception protection for window.requestAnimationFrame to handle\n * exceptions.\n */\ngoog.debug.ErrorHandler.prototype.protectWindowRequestAnimationFrame =\n    function() {\n  'use strict';\n  var win = goog.global['window'];\n  var fnNames = [\n    'requestAnimationFrame', 'mozRequestAnimationFrame', 'webkitAnimationFrame',\n    'msRequestAnimationFrame'\n  ];\n  for (var i = 0; i < fnNames.length; i++) {\n    var fnName = fnNames[i];\n    if (fnNames[i] in win) {\n      this.protectWindowFunctionsHelper_(fnName);\n    }\n  }\n};\n\n\n/**\n * Helper function for protecting a function that causes a function to be\n * asynchronously called, for example setTimeout or requestAnimationFrame.\n * @param {string} fnName The name of the function to protect.\n * @private\n */\ngoog.debug.ErrorHandler.prototype.protectWindowFunctionsHelper_ = function(\n    fnName) {\n  'use strict';\n  var win = goog.global['window'];\n  var originalFn = win[fnName];\n  var that = this;\n  win[fnName] = function(fn, time) {\n    'use strict';\n    // Don't try to protect strings. In theory, we could try to globalEval\n    // the string, but this seems to lead to permission errors on IE6.\n    if (typeof fn === 'string') {\n      fn = goog.partial(goog.globalEval, fn);\n    }\n    arguments[0] = fn = that.protectEntryPoint(fn);\n\n    // IE doesn't support .call for setInterval/setTimeout, but it\n    // also doesn't care what \"this\" is, so we can just call the\n    // original function directly\n    if (originalFn.apply) {\n      return originalFn.apply(/** @type {?} */ (this), arguments);\n    } else {\n      var callback = fn;\n      if (arguments.length > 2) {\n        var args = Array.prototype.slice.call(arguments, 2);\n        callback = function() {\n          'use strict';\n          fn.apply(/** @type {?} */ (this), args);\n        };\n      }\n      return originalFn(callback, time);\n    }\n  };\n  win[fnName][this.getFunctionIndex_(false)] = originalFn;\n};\n\n\n/**\n * Set whether to wrap errors that occur in protected functions in a\n * goog.debug.ErrorHandler.ProtectedFunctionError.\n * @param {boolean} wrapErrors Whether to wrap errors.\n */\ngoog.debug.ErrorHandler.prototype.setWrapErrors = function(wrapErrors) {\n  'use strict';\n  this.wrapErrors_ = wrapErrors;\n};\n\n\n/**\n * Set whether to add a prefix to all error messages that occur in protected\n * functions.\n * @param {boolean} prefixErrorMessages Whether to add a prefix to error\n *     messages.\n */\ngoog.debug.ErrorHandler.prototype.setPrefixErrorMessages = function(\n    prefixErrorMessages) {\n  'use strict';\n  this.prefixErrorMessages_ = prefixErrorMessages;\n};\n\n\n/** @override */\ngoog.debug.ErrorHandler.prototype.disposeInternal = function() {\n  'use strict';\n  // Try to unwrap window.setTimeout and window.setInterval.\n  var win = goog.global['window'];\n  win.setTimeout = this.unwrap(win.setTimeout);\n  win.setInterval = this.unwrap(win.setInterval);\n\n  goog.debug.ErrorHandler.base(this, 'disposeInternal');\n};\n\n\n\n/**\n * Error thrown to the caller of a protected entry point if the entry point\n * throws an error.\n * @param {*} cause The error thrown by the entry point.\n * @constructor\n * @extends {goog.debug.Error}\n * @final\n */\ngoog.debug.ErrorHandler.ProtectedFunctionError = function(cause) {\n  'use strict';\n  /** @suppress {missingProperties} message may not be defined. */\n  var message = goog.debug.ErrorHandler.ProtectedFunctionError.MESSAGE_PREFIX +\n      (cause && cause.message ? String(cause.message) : String(cause));\n  goog.debug.ErrorHandler.ProtectedFunctionError.base(\n      this, 'constructor', message);\n\n  /**\n   * The error thrown by the entry point.\n   * @type {*}\n   */\n  this.cause = cause;\n\n  /** @suppress {missingProperties} stack may not be defined. */\n  var stack = cause && cause.stack;\n  if (stack && typeof stack === 'string') {\n    this.stack = /** @type {string} */ (stack);\n  }\n};\ngoog.inherits(goog.debug.ErrorHandler.ProtectedFunctionError, goog.debug.Error);\n\n\n/**\n * Text to prefix the message with.\n * @type {string}\n */\ngoog.debug.ErrorHandler.ProtectedFunctionError.MESSAGE_PREFIX =\n    'Error in protected function: ';\n"],
"names":["goog","provide","require","debug","ErrorHandler","goog.debug.ErrorHandler","handler","base","errorHandlerFn_","wrapErrors_","prefixErrorMessages_","inherits","Disposable","prototype","addTracersToProtectedFunctions_","setAddTracersToProtectedFunctions","goog.debug.ErrorHandler.prototype.setAddTracersToProtectedFunctions","newVal","wrap","goog.debug.ErrorHandler.prototype.wrap","fn","protectEntryPoint","asserts","assertFunction","unwrap","goog.debug.ErrorHandler.prototype.unwrap","getFunctionIndex_","getStackTraceHolder_","goog.debug.ErrorHandler.prototype.getStackTraceHolder_","stackTrace","buffer","push","replace","join","goog.debug.ErrorHandler.prototype.getFunctionIndex_","wrapper","getUid","goog.debug.ErrorHandler.prototype.protectEntryPoint","protectedFnName","getProtectedFunction","goog.debug.ErrorHandler.prototype.getProtectedFunction","that","tracers","getStacktraceSimple","googDebugErrorHandlerProtectedFunction","self","isDisposed","apply","arguments","tracer","Trace","startTracer","e","handleError_","stopTracer","goog.debug.ErrorHandler.prototype.handleError_","MESSAGE_PREFIX","ProtectedFunctionError","message","indexOf","DEBUG","stack","Error","captureStackTrace","global","protectWindowSetTimeout","goog.debug.ErrorHandler.prototype.protectWindowSetTimeout","protectWindowFunctionsHelper_","protectWindowSetInterval","goog.debug.ErrorHandler.prototype.protectWindowSetInterval","catchUnhandledRejections","goog.debug.ErrorHandler.prototype.catchUnhandledRejections","win","onunhandledrejection","event","win.onunhandledrejection","reason","protectWindowRequestAnimationFrame","goog.debug.ErrorHandler.prototype.protectWindowRequestAnimationFrame","fnNames","i","length","fnName","goog.debug.ErrorHandler.prototype.protectWindowFunctionsHelper_","originalFn","time","partial","globalEval","callback","args","Array","slice","call","setWrapErrors","goog.debug.ErrorHandler.prototype.setWrapErrors","wrapErrors","setPrefixErrorMessages","goog.debug.ErrorHandler.prototype.setPrefixErrorMessages","prefixErrorMessages","disposeInternal","goog.debug.ErrorHandler.prototype.disposeInternal","setTimeout","setInterval","goog.debug.ErrorHandler.ProtectedFunctionError","cause","String"]
}
